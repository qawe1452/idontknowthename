<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ğŸ–¤ å‘½é‹ä¹‹é¸ - ç ´å†°å®Œæ•´ä¿®æ­£ç‰ˆ</title>
    <style>
        :root {
            --male-color: #00d2ff;
            --female-color: #ff75c3;
            --primary: #8e44ad;
            --bg-black: #121212;
            --card-bg: #1e1e1e;
            --easy-color: #27ae60;
            --normal-color: #f39c12;
            --hard-color: #e74c3c;
        }
        
        * { box-sizing: border-box; }

        body { font-family: 'PingFang TC', sans-serif; background: var(--bg-black); color: #e0e0e0; margin: 0; display: flex; justify-content: center; min-height: 100vh; overflow-x: hidden; }
        .page { width: 100%; max-width: 500px; padding: 25px; box-sizing: border-box; display: none; text-align: center; }
        .active { display: block; animation: fadeIn 0.6s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }


        /* å½ˆçª—æ¨£å¼ */
        .overlay { position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.9); display:none; flex-direction:column; justify-content:center; align-items:center; z-index: 2000; padding: 20px; box-sizing: border-box; text-align: center; }
        .modal { background: #222; border: 2px solid var(--primary); border-radius: 20px; padding: 25px; width: 90%; max-width: 400px; }
        
        /* è¦å‰‡èªªæ˜æ›è¡Œæ¨£å¼ */
        .rule-item { text-align: left; margin: 15px 0; font-size: 15px; line-height: 1.6; }

        /* é›£åº¦é¸æ“‡èˆ‡é–å®š */
        .difficulty-group { display: flex; gap: 10px; margin: 20px 0; transition: 0.3s; }
        .diff-btn { flex: 1; padding: 12px; border-radius: 10px; border: 2px solid transparent; cursor: pointer; font-weight: bold; color: white; opacity: 0.4; transition: 0.3s; }
        .diff-btn.selected { opacity: 1; transform: scale(1.05); border-color: white; }
        .diff-btn:disabled { opacity: 0.15; cursor: not-allowed; transform: scale(1); }

        /* è¼¸å…¥ä½ˆå±€ */
        .input-group { display: flex; gap: 15px; margin-bottom: 25px; }
        .column { flex: 1; display: flex; flex-direction: column; gap: 10px; }
        input { padding: 12px; background: #2c2c2c; border: 1px solid #444; border-radius: 8px; font-size: 16px; color: white; outline: none; width: 100%; }
        
        .btn { padding: 15px; border: none; border-radius: 12px; background: var(--primary); color: white; font-size: 18px; font-weight: bold; cursor: pointer; width: 100%; margin-top: 10px; }
        .btn-add { background: #333; color: #bbb; padding: 8px; font-size: 14px; margin-bottom: 10px; border-radius: 10px; border: none; cursor: pointer; }

	/* é›£åº¦é¸æ“‡æŒ‰éˆ• */
        .difficulty-group { display: flex; gap: 10px; margin: 20px 0; }
        .diff-btn { flex: 1; padding: 10px; border-radius: 8px; border: 2px solid transparent; cursor: pointer; font-weight: bold; color: white; opacity: 0.5; transition: 0.3s; }
        .diff-btn.selected { opacity: 1; transform: scale(1.05); border-color: white; }
        .btn-easy { background: var(--easy-color); }
        .btn-normal { background: var(--normal-color); }
        .btn-hard { background: var(--hard-color); }

        /* éŠæˆ²å€åŸŸ */
        .selected-players-box { background: var(--card-bg); padding: 20px; border-radius: 20px; border: 1px solid #333; margin-bottom: 20px; }
        .main-player-tag { display: inline-block; padding: 12px 30px; background: #222; border: 2px solid #f1c40f; color: #f1c40f; border-radius: 30px; margin: 15px; font-size: 26px; font-weight: bold; }

        /* å¡ç‰Œ 3D çµæ§‹ */
        .card-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; margin-top: 20px; }
        .card { aspect-ratio: 2/3; perspective: 1000px; cursor: pointer; width: 100%; }
        .card-inner { position: relative; width: 100%; height: 100%; transition: transform 0.6s; transform-style: preserve-3d; }
        .card.flipped .card-inner { transform: rotateY(180deg); }
        .card-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 8px; border: 2px solid #555; display: flex; align-items: center; justify-content: center; box-sizing: border-box; }
        .card-back { background: linear-gradient(135deg, #2c3e50, #000); color: white; font-size: 24px; }
        .card-front { background: #fff; color: #000; transform: rotateY(180deg); font-size: 11px; font-weight: bold; padding: 5px; text-align: center; }
	
	/* è®“å¡ç‰‡æ­£é¢å¯ä»¥å‚ç›´ä½ˆå±€ */
	.card-front {
    		display: flex;
    		flex-direction: column;
    		align-items: center;
    		justify-content: center;
    		padding: 10px;
	}

	.card-img {
    		width: 80%;
    		height: 50%;
    		object-fit: cover;
    		border-radius: 5px;
    		margin-bottom: 10px;
	}

	.card-desc {
    		font-size: 12px;
    		color: #333;
    		line-height: 1.4;
    		white-space: pre-wrap;
	}

        /* æŒ‡ä»¤æ›è¡Œæ”¯æ´ */
        .cmd-text { font-size: 28px; font-weight: bold; color: #f1c40f; margin: 20px 0; white-space: pre-wrap; line-height: 1.4; }
    </style>
</head>
<body>

<div id="introOverlay" class="overlay" style="display: flex;">
    <div class="modal">
        <h2 style="color:var(--primary)">ğŸ‘‘ ç ´å†°å¤§å†’éšªèªªæ˜</h2>
        <div class="rule-item">
            <strong style="color:var(--easy-color)">ğŸŸ¢ ç°¡å–®æ¨¡å¼ï¼š</strong><br>åŸºæœ¬äº¤æµèˆ‡å•å€™ï¼Œé©åˆå‰›è¦‹é¢æ™‚ã€‚
        </div>
        <div class="rule-item">
            <strong style="color:var(--normal-color)">ğŸŸ  æ™®é€šæ¨¡å¼ï¼š</strong><br>è¶£å‘³äº’å‹•èˆ‡å°æ¥è§¸ï¼Œæ‰“ç ´å°·å°¬æ„Ÿã€‚
        </div>
        <div class="rule-item">
            <strong style="color:var(--hard-color)">ğŸ”´ å›°é›£æ¨¡å¼ï¼š</strong><br>é«˜å¼·åº¦çš„è¦ªå¯†æŒ‘æˆ°ï¼Œé©åˆç†±çµ¡å¾Œã€‚
        </div>
        <button class="btn" onclick="document.getElementById('introOverlay').style.display='none'">é–‹å§‹è¨­å®šè§’è‰²</button>
    </div>
</div>

<div id="page1" class="page active">
    <h1>ğŸ§Š è§’è‰²è¨­å®š</h1>
    <div class="input-group">
        <div class="column" id="maleCol">
            <div style="color:var(--male-color); font-weight: bold;">ç”·ç”Ÿ â™‚</div>
            <input type="text" class="male-in" placeholder="æš±ç¨±">
            <input type="text" class="male-in" placeholder="æš±ç¨±">
            <button class="btn-add" onclick="addNewInput('maleCol')">+ å¢åŠ äººæ•¸</button>
        </div>
        <div class="column" id="femaleCol">
            <div style="color:var(--female-color); font-weight: bold;">å¥³ç”Ÿ â™€</div>
            <input type="text" class="female-in" placeholder="æš±ç¨±">
            <input type="text" class="female-in" placeholder="æš±ç¨±">
            <button class="btn-add" onclick="addNewInput('femaleCol')">+ å¢åŠ äººæ•¸</button>
        </div>
    </div>
    <button class="btn" onclick="goToPage2()">é€²å…¥å¤§å»³</button>
</div>

<div id="page2" class="page">
    <h1>ğŸ¯ å‘½é‹å¤§å»³</h1>
    <div class="difficulty-group" id="diffGroup">
        <button class="diff-btn btn-easy selected" onclick="setDiff('easy', this)">ç°¡å–®</button>
        <button class="diff-btn btn-normal" onclick="setDiff('normal', this)">æ™®é€š</button>
        <button class="diff-btn btn-hard" onclick="setDiff('hard', this)">å›°é›£</button>
    </div>

    <div id="displaySelection" class="selected-players-box">
        <p style="color:#888;">è«‹é¸æ“‡é›£åº¦å¾ŒæŠ½å‡ºä¸»è§’</p>
    </div>
    <button class="btn" id="drawBtn" onclick="drawMainPlayer()">æŠ½å‡ºä¸»è§’</button>
    
    <div id="cardSection" style="display:none; margin-top: 30px;">
        <h3 style="color:#aaa;">ğŸƒ è«‹é¸ä¸€å¼µä»»å‹™å¡</h3>
        <div class="card-grid" id="cardGrid"></div>
    </div>
</div>

<div id="resultOverlay" class="overlay">
    <div style="background: white; width: 90%; max-width: 360px; border-radius: 25px; overflow: hidden; color: #333; box-shadow: 0 10px 30px rgba(0,0,0,0.5); animation: cardPop 0.4s ease-out;">
        
        <div style="background: var(--primary); color: white; padding: 15px; font-weight: bold; font-size: 20px; text-align: center;">
            âœ¨ å‘½é‹ä»»å‹™å¡
        </div>
        
        <div style="width: 100%; height: 220px; background: #f0f0f0;">
            <img id="missionImg" src="" alt="ä»»å‹™ç¯„ä¾‹" style="width: 100%; height: 100%; object-fit: cover;">
        </div>

        <div style="padding: 25px; text-align: left;">
            <div style="display: flex; justify-content: space-between; align-items: center; border-bottom: 2px dashed #eee; padding-bottom: 15px; margin-bottom: 15px;">
                <div>
                    <div style="font-size: 12px; color: #888;">åŸ·è¡Œè€…</div>
                    <div id="finalMain" style="font-size: 20px; font-weight: bold; color: var(--primary);"></div>
                </div>
                <div style="font-size: 24px;">âš¡</div>
                <div style="text-align: right;">
                    <div style="font-size: 12px; color: #888;">å°è±¡</div>
                    <div id="finalTarget" style="font-size: 20px; font-weight: bold;"></div>
                </div>
            </div>

            <div style="font-size: 13px; color: #999; margin-bottom: 5px;">ä»»å‹™å…§å®¹ï¼š</div>
            <div id="finalCommand" style="font-size: 22px; font-weight: bold; color: #2c3e50; line-height: 1.4; min-height: 60px;"></div>
        </div>

        <div style="padding: 0 25px 25px 25px;">
            <button class="btn" onclick="resetGame()" style="margin: 0; width: 100%; background: #333;">æˆ‘æ¥å—æŒ‘æˆ°</button>
        </div>
    </div>
</div>

<style>
/* å¢åŠ ä¸€å€‹å½ˆå‡ºçš„å‹•ç•«æ•ˆæœ */
@keyframes cardPop {
    0% { transform: scale(0.7); opacity: 0; }
    100% { transform: scale(1); opacity: 1; }
}
</style><div id="resultOverlay" class="overlay">
    <div style="background: white; width: 90%; max-width: 360px; border-radius: 25px; overflow: hidden; color: #333; box-shadow: 0 10px 30px rgba(0,0,0,0.5); animation: cardPop 0.4s ease-out;">
        
        <div style="background: var(--primary); color: white; padding: 15px; font-weight: bold; font-size: 20px; text-align: center;">
            âœ¨ å‘½é‹ä»»å‹™å¡
        </div>
        
        <div style="width: 100%; height: 220px; background: #f0f0f0;">
            <img id="missionImg" src="" alt="ä»»å‹™ç¯„ä¾‹" style="width: 100%; height: 100%; object-fit: cover;">
        </div>

        <div style="padding: 25px; text-align: left;">
            <div style="display: flex; justify-content: space-between; align-items: center; border-bottom: 2px dashed #eee; padding-bottom: 15px; margin-bottom: 15px;">
                <div>
                    <div style="font-size: 12px; color: #888;">åŸ·è¡Œè€…</div>
                    <div id="finalMain" style="font-size: 20px; font-weight: bold; color: var(--primary);"></div>
                </div>
                <div style="font-size: 24px;">âš¡</div>
                <div style="text-align: right;">
                    <div style="font-size: 12px; color: #888;">å°è±¡</div>
                    <div id="finalTarget" style="font-size: 20px; font-weight: bold;"></div>
                </div>
            </div>

            <div style="font-size: 13px; color: #999; margin-bottom: 5px;">ä»»å‹™å…§å®¹ï¼š</div>
            <div id="finalCommand" style="font-size: 22px; font-weight: bold; color: #2c3e50; line-height: 1.4; min-height: 60px;"></div>
        </div>

        <div style="padding: 0 25px 25px 25px;">
            <button class="btn" onclick="resetGame()" style="margin: 0; width: 100%; background: #333;">æˆ‘æ¥å—æŒ‘æˆ°</button>
        </div>
    </div>
</div>

<style>
/* å¢åŠ ä¸€å€‹å½ˆå‡ºçš„å‹•ç•«æ•ˆæœ */
@keyframes cardPop {
    0% { transform: scale(0.7); opacity: 0; }
    100% { transform: scale(1); opacity: 1; }
}
</style>

<script>
    let currentDiff = 'easy';
    let mainPlayer = null;
    let targetPlayer = '';

    // å‡ç´šç‰ˆé¡Œåº«ï¼šåŒ…å«æ–‡å­—èˆ‡åœ–ç‰‡
    const db = {
        m: {
            easy: [
                { text: "ä¸»å‹•èˆ‡å°è±¡æ¡æ‰‹ä¸¦è‡ªæˆ‘ä»‹ç´¹", img: "https://images.unsplash.com/photo-1516733725897-1aa73b87c8e8?w=500" },
                { text: "èª‡çå°è±¡ä»Šå¤©çš„ç©¿æ­å¾ˆç‰¹åˆ¥", img: "https://images.unsplash.com/photo-1517841905240-472988babdf9?w=500" }
            ],
            normal: [
                { text: "å¹«å°è±¡è¼•è¼•æŒ‰æ‘©è‚©è†€ 30 ç§’", img: "https://images.unsplash.com/photo-1544161515-4ae6ce6ca8b8?w=500" }
            ],
            hard: [
                { text: "æ·±æƒ…å°è¦– 10 ç§’ä¸å‡†ç¬‘", img: "https://images.unsplash.com/photo-1516062423079-7ca13cdc7f5a?w=500" }
            ]
        },
        f: {
            easy: [
                { text: "å°è‘—å°è±¡åšä¸€å€‹å¯æ„›çš„è¡¨æƒ…", img: "https://images.unsplash.com/photo-1520315342629-6ea920342047?w=500" }
            ],
            normal: [
                { text: "èˆ‡å°è±¡åˆç…§ä¸€å¼µä¸¦ä¸Šå‚³å‹•æ…‹", img: "https://images.unsplash.com/photo-1492684223066-81342ee5ff30?w=500" }
            ],
            hard: [
                { text: "çµ¦å°è±¡ä¸€å€‹æº«æš–çš„æ“æŠ±", img: "https://images.unsplash.com/photo-1517365830460-955ce3ccd263?w=500" }
            ]
        }
    };

    function addInput(type) {
        const container = document.getElementById(type + 'Inputs');
        const input = document.createElement('input');
        input.type = 'text';
        input.className = type + '-in';
        input.placeholder = 'è¼¸å…¥æš±ç¨±...';
        container.appendChild(input);
    }

    function getNames(selector) {
        return Array.from(document.querySelectorAll(selector))
            .map(i => i.value.trim())
            .filter(v => v !== '');
    }

    function goToPage2() {
        const m = getNames('.male-in');
        const f = getNames('.female-in');
        if (m.length === 0 || f.length === 0) {
            alert('ç”·ç”Ÿå¥³ç”Ÿéƒ½è¦è‡³å°‘è¼¸å…¥ä¸€äººå–”ï¼');
            return;
        }
        document.getElementById('page1').classList.remove('active');
        document.getElementById('page2').classList.add('active');
    }

    function setDiff(diff, btn) {
        currentDiff = diff;
        document.querySelectorAll('.diff-btn').forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
    }

    function drawMainPlayer() {
        document.querySelectorAll('.diff-btn').forEach(btn => btn.disabled = true);
        const m = getNames('.male-in');
        const f = getNames('.female-in');
        
        // å»ºç«‹å…¨å“¡åå–®
        const all = [...m.map(n => ({name: n, gender: 'm'})), ...f.map(n => ({name: n, gender: 'f'}))];
        
        // éš¨æ©ŸæŠ½ä¸»è§’
        mainPlayer = all[Math.floor(Math.random() * all.length)];

        // ç¯©é¸å°è±¡ï¼šç•°æ€§ OR è‡ªå·±
        const targets = all.filter(p => p.gender !== mainPlayer.gender || p.name === mainPlayer.name);
        const chosenTarget = targets[Math.floor(Math.random() * targets.length)];
        targetPlayer = chosenTarget.name;

        document.getElementById('displaySelection').innerHTML = `
            <p style="color:#bbb;">é¸ä¸­ä¸»è§’ï¼š</p>
            <span class="main-player-tag">${mainPlayer.name}</span>
        `;
        document.getElementById('drawBtn').style.display = 'none';
        document.getElementById('cardSection').style.display = 'block';
        generateCards();
    }

    function generateCards() {
        const grid = document.getElementById('cardGrid');
        grid.innerHTML = '';
        for (let i = 1; i <= 10; i++) {
            const card = document.createElement('div');
            card.className = 'card';
            card.innerHTML = `
                <div class="card-inner">
                    <div class="card-face card-back">?</div>
                    <div class="card-face card-front">ä»»å‹™</div>
                </div>`;
            
            card.onclick = () => {
                if (card.classList.contains('flipped')) return;
                card.classList.add('flipped');

                setTimeout(() => {
                    const pool = db[mainPlayer.gender][currentDiff];
                    const task = pool[Math.floor(Math.random() * pool.length)];

                    document.getElementById('finalMain').innerText = mainPlayer.name;
                    
                    // è™•ç†å°è±¡é¡¯ç¤º
                    const targetDisplay = document.getElementById('finalTarget');
                    if (targetPlayer === mainPlayer.name) {
                        targetDisplay.innerText = "ä½ è‡ªå·± (ç¾æ¥æŒ‘æˆ°!)";
                        targetDisplay.style.color = "#e74c3c";
                    } else {
                        targetDisplay.innerText = targetPlayer;
                        targetDisplay.style.color = (mainPlayer.gender === 'm' ? 'var(--female-color)' : 'var(--male-color)');
                    }

                    document.getElementById('finalCommand').innerText = task.text;
                    document.getElementById('missionImg').src = task.img;
                    document.getElementById('resultOverlay').style.display = 'flex';
                }, 600);
            };
            grid.appendChild(card);
        }
    }

    function resetGame() {
        document.querySelectorAll('.diff-btn').forEach(btn => btn.disabled = false);
        document.getElementById('resultOverlay').style.display = 'none';
        document.getElementById('cardSection').style.display = 'none';
        document.getElementById('drawBtn').style.display = 'block';
        document.getElementById('displaySelection').innerHTML = '<p style="color:#888;">è«‹é¸æ“‡é›£åº¦å¾ŒæŠ½å‡ºä¸»è§’</p>';
    }
</script>
</body>
</html>