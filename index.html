<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ğŸ–¤ å‘½é‹ä¹‹é¸ - å¾©å¤ä»»å‹™ä¿®æ­£ç‰ˆ</title>
    <style>
    :root {
        --male-color: #00d2ff;
        --female-color: #ff75c3;
        --primary: #8e44ad;
        --bg-black: #121212;
        --card-bg: #1e1e1e;
        --easy-color: #27ae60;
        --normal-color: #f39c12;
        --hard-color: #e74c3c;
        --vintage-bg: #5d1b3b; 
        --vintage-border: #f8bbd0;
    }

    body { font-family: 'PingFang TC', sans-serif; background: var(--bg-black); color: #e0e0e0; margin: 0; display: flex; justify-content: center; min-height: 100vh; overflow-x: hidden; }
    
    /* ä¿®æ­£é é¢å®¹å™¨èˆ‡é–“è· */
    .page { width: 100%; max-width: 500px; padding: 40px 25px; box-sizing: border-box; display: none; text-align: center; }
    .active { display: block; animation: fadeIn 0.6s; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

    h1 { margin-bottom: 30px; font-size: 28px; letter-spacing: 2px; }

    /* è§’è‰²è¨­å®šä½ˆå±€ä¿®æ­£ */
    .input-group { display: flex; gap: 20px; margin-bottom: 30px; align-items: flex-start; }
    .column { flex: 1; display: flex; flex-direction: column; gap: 12px; }
    
    .gender-label { font-weight: bold; font-size: 18px; margin-bottom: 5px; }
    
    input { 
        padding: 12px; 
        background: #2c2c2c; 
        border: 1px solid #444; 
        border-radius: 8px; 
        color: white; 
        width: 100%; 
        box-sizing: border-box; 
        font-size: 16px;
    }

    /* æŒ‰éˆ•æ¨£å¼ */
    .btn { padding: 15px; border-radius: 12px; background: var(--primary); color: white; font-weight: bold; cursor: pointer; border: none; font-size: 16px; transition: 0.3s; }
    .btn:active { transform: scale(0.98); }
    .add-btn { background: #333; font-size: 13px; padding: 8px; margin-top: 5px; }

    /* é›£åº¦èˆ‡å¤§å»³ */
    .difficulty-group { display: flex; gap: 10px; margin: 25px 0; }
    .diff-btn { flex: 1; padding: 12px; border-radius: 10px; border: 2px solid transparent; color: white; opacity: 0.4; cursor: pointer; font-weight: bold; }
    .diff-btn.selected { opacity: 1; border-color: white; transform: scale(1.05); }

    /* å¡ç‰Œç¶²æ ¼ */
    .card-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; margin-top: 25px; }
    .card { aspect-ratio: 2/3; perspective: 1000px; cursor: pointer; }
    .card-inner { position: relative; width: 100%; height: 100%; transition: transform 0.6s; transform-style: preserve-3d; }
    .card.flipped .card-inner { transform: rotateY(180deg); }
    .card-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 8px; border: 1px solid #444; display: flex; align-items: center; justify-content: center; }
    .card-back { background: linear-gradient(135deg, #2c3e50, #000); color: #fff; font-size: 20px; font-weight: bold; }
    .card-front { background: #fff; color: #000; transform: rotateY(180deg); font-size: 14px; font-weight: bold; }

    /* å¾©å¤ä»»å‹™å¡æ¨£å¼ */
    .overlay { position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.92); display:none; flex-direction:column; justify-content:center; align-items:center; z-index: 2000; padding: 20px; box-sizing: border-box; }
    .vintage-card { background: var(--vintage-bg); width: 100%; max-width: 380px; padding: 15px; border-radius: 20px; box-shadow: 0 0 50px rgba(0,0,0,0.9); animation: cardPop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
    .card-border { border: 2px solid var(--vintage-border); border-radius: 15px; padding: 15px; }
    .image-frame { width: 100%; aspect-ratio: 4 / 3; background: #222; border-radius: 10px; overflow: hidden; margin-bottom: 20px; border: 2px solid var(--vintage-border); }
    .image-frame img { width: 100%; height: 100%; object-fit: cover; }
    .info-section { background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(248, 187, 208, 0.5); border-radius: 10px; padding: 15px; color: var(--vintage-border); text-align: left; }
    .player-line { font-size: 16px; margin-bottom: 10px; border-bottom: 1px dashed rgba(248, 187, 208, 0.3); padding-bottom: 5px; }
    .command-line { font-size: 22px; font-weight: bold; color: #ffffff; margin-top: 12px; line-height: 1.4; }
    .accept-btn { margin-top: 20px; background: var(--vintage-border); color: var(--vintage-bg); border: none; padding: 15px; border-radius: 30px; font-weight: bold; cursor: pointer; width: 100%; font-size: 18px; }

    @keyframes cardPop { from { transform: scale(0.7); opacity: 0; } to { transform: scale(1); opacity: 1; } }
    </style>
</head>
<body>

<div id="page1" class="page active">
    <h1>ğŸ§Š è§’è‰²è¨­å®š</h1>
    <div class="input-group">
        <div class="column">
            <div class="gender-label" style="color:var(--male-color);">ç”·ç”Ÿ â™‚</div>
            <div id="maleInputs" class="column">
                <input type="text" class="male-in" placeholder="æš±ç¨±">
                <input type="text" class="male-in" placeholder="æš±ç¨±">
            </div>
            <button class="btn add-btn" onclick="addInput('male')">+ å¢åŠ äººæ•¸</button>
        </div>
        <div class="column">
            <div class="gender-label" style="color:var(--female-color);">å¥³ç”Ÿ â™€</div>
            <div id="femaleInputs" class="column">
                <input type="text" class="female-in" placeholder="æš±ç¨±">
                <input type="text" class="female-in" placeholder="æš±ç¨±">
            </div>
            <button class="btn add-btn" onclick="addInput('female')">+ å¢åŠ äººæ•¸</button>
        </div>
    </div>
    <button class="btn" style="width: 100%; margin-top: 20px;" onclick="goToPage2()">é€²å…¥å¤§å»³</button>
</div>

<div id="page2" class="page">
    <h1>ğŸ¯ å‘½é‹å¤§å»³</h1>
    <div class="difficulty-group">
        <button class="diff-btn" style="background:var(--easy-color)" onclick="setDiff('easy', this)">ç°¡å–®</button>
        <button class="diff-btn selected" style="background:var(--normal-color)" onclick="setDiff('normal', this)">æ™®é€š</button>
        <button class="diff-btn" style="background:var(--hard-color)" onclick="setDiff('hard', this)">å›°é›£</button>
    </div>
    <div id="displaySelection" style="background:var(--card-bg); padding:30px; border-radius:20px; margin-bottom:25px; min-height: 80px; display: flex; align-items: center; justify-content: center;">
        <p style="color:#888; margin: 0;">è«‹é»æ“ŠæŒ‰éˆ•æŠ½å‡ºä¸»è§’</p>
    </div>
    <button class="btn" id="drawBtn" style="width: 100%;" onclick="drawMainPlayer()">æŠ½å‡ºä¸»è§’</button>
    
    <div id="cardSection" style="display:none; margin-top: 35px;">
        <h3 style="color:#aaa; margin-bottom: 15px;">ğŸƒ è«‹é¸ä¸€å¼µä»»å‹™å¡</h3>
        <div class="card-grid" id="cardGrid"></div>
    </div>
</div>

<div id="resultOverlay" class="overlay">
    <div class="vintage-card">
        <div class="card-border">
            <div class="image-frame">
                <img id="missionImg" src="" alt="ä»»å‹™åœ–">
            </div>
            <div class="info-section">
                <div class="player-line">åŸ·è¡Œè€…ï¼š<span id="finalMain" style="color:#fff;"></span></div>
                <div class="player-line">å°è±¡ï¼š<span id="finalTarget"></span></div>
                <div id="finalCommand" class="command-line"></div>
            </div>
        </div>
        <button class="accept-btn" onclick="resetGame()">æ¥å—æŒ‘æˆ°</button>
    </div>
</div>

<script>
    let currentDiff = 'normal';
    let mainPlayer = null;
    let targetPlayer = '';

    const db = {
        m: {
            easy: [{ text: "ä¸»å‹•èˆ‡å°è±¡æ¡æ‰‹ä¸¦ä»‹ç´¹è‡ªå·±", img: "https://images.unsplash.com/photo-1516733725897-1aa73b87c8e8?w=500" }],
            normal: [{ text: "å¹«å°è±¡è¼•è¼•æŒ‰æ‘©è‚©è†€ 30 ç§’", img: "https://images.unsplash.com/photo-1544161515-4ae6ce6ca8b8?w=500" }],
            hard: [{ text: "çµ¦å°è±¡ä¸€å€‹æš–å¿ƒçš„æ“æŠ± 10 ç§’", img: "https://images.unsplash.com/photo-1517365830460-955ce3ccd263?w=500" }]
        },
        f: {
            easy: [{ text: "å°è‘—å°è±¡åšä¸€å€‹å¯æ„›çš„è¡¨æƒ…", img: "https://images.unsplash.com/photo-1520315342629-6ea920342047?w=500" }],
            normal: [{ text: "èˆ‡å°è±¡åˆç…§ä¸€å¼µä¸¦ä¸Šå‚³å‹•æ…‹", img: "https://images.unsplash.com/photo-1492684223066-81342ee5ff30?w=500" }],
            hard: [{ text: "çµ¦å°è±¡ä¸€å€‹æ·±æƒ…çš„æ“æŠ±", img: "https://images.unsplash.com/photo-1516062423079-7ca13cdc7f5a?w=500" }]
        }
    };

    function addInput(type) {
        const container = document.getElementById(type + 'Inputs');
        const input = document.createElement('input');
        input.type = 'text'; input.className = type + '-in'; input.placeholder = 'æš±ç¨±';
        container.appendChild(input);
    }

    function getNames(selector) {
        return Array.from(document.querySelectorAll(selector)).map(i => i.value.trim()).filter(v => v !== '');
    }

    function goToPage2() {
        if (getNames('.male-in').length === 0 || getNames('.female-in').length === 0) {
            alert('ç”·ç”Ÿå¥³ç”Ÿéƒ½è¦è‡³å°‘è¼¸å…¥ä¸€äººå–”ï¼'); return;
        }
        document.getElementById('page1').classList.remove('active');
        document.getElementById('page2').classList.add('active');
    }

    function setDiff(diff, btn) {
    	// åªæœ‰åœ¨æŒ‰éˆ•æœªè¢«åœç”¨ï¼ˆdisabledï¼‰æ™‚æ‰èƒ½åˆ‡æ›
    	if (btn.disabled) return; 

    	currentDiff = diff;
    
    	// æ¸…é™¤æ‰€æœ‰æŒ‰éˆ•çš„é¸ä¸­æ¨£å¼ï¼Œä¸¦ç‚ºç•¶å‰é»æ“Šçš„æŒ‰éˆ•åŠ ä¸Šé¸ä¸­æ¨£å¼
    	document.querySelectorAll('.diff-btn').forEach(b => b.classList.remove('selected'));
    	btn.classList.add('selected');
}

    function drawMainPlayer() {
    // --- é—œéµä¿®æ­£ï¼šç¢ºå¯¦é–å®šé›£åº¦æŒ‰éˆ• ---
    // å–å¾—æ‰€æœ‰é›£åº¦æŒ‰éˆ•ä¸¦è¨­ç‚º disabled
    document.querySelectorAll('.diff-btn').forEach(btn => {
        btn.disabled = true;
        btn.style.cursor = 'not-allowed'; // å¢åŠ è¦–è¦ºæç¤ºï¼Œè®“ç©å®¶çŸ¥é“ä¸èƒ½æŒ‰
    });

    const m = getNames('.male-in');
    const f = getNames('.female-in');
    const all = [...m.map(n => ({name: n, gender: 'm'})), ...f.map(n => ({name: n, gender: 'f'}))];
    
    mainPlayer = all[Math.floor(Math.random() * all.length)];
    const targets = all.filter(p => p.gender !== mainPlayer.gender || p.name === mainPlayer.name);
    targetPlayer = targets[Math.floor(Math.random() * targets.length)].name;

    document.getElementById('displaySelection').innerHTML = `
        <div style="text-align: center;">
            <span style="color:#888; font-size: 14px;">é¸ä¸­ä¸»è§’ï¼š</span><br>
            <span style="font-size:26px; color:#f1c40f; font-weight:bold;">${mainPlayer.name}</span>
        </div>`;
    document.getElementById('drawBtn').style.display = 'none';
    document.getElementById('cardSection').style.display = 'block';
    generateCards();
}

    function generateCards() {
        const grid = document.getElementById('cardGrid');
        grid.innerHTML = '';
        for (let i = 1; i <= 10; i++) {
            const card = document.createElement('div');
            card.className = 'card';
            card.innerHTML = `<div class="card-inner"><div class="card-face card-back">?</div><div class="card-face card-front">ä»»å‹™</div></div>`;
            card.onclick = () => {
                if (card.classList.contains('flipped')) return;
                card.classList.add('flipped');
                setTimeout(() => {
                    const pool = db[mainPlayer.gender][currentDiff];
                    const task = pool[Math.floor(Math.random() * pool.length)];
                    document.getElementById('finalMain').innerText = mainPlayer.name;
                    
                    const targetEl = document.getElementById('finalTarget');
                    if (targetPlayer === mainPlayer.name) {
                        targetEl.innerText = "ä½ è‡ªå·± (ç¾æ¥æŒ‘æˆ°!)";
                        targetEl.style.color = "#e74c3c";
                    } else {
                        targetEl.innerText = targetPlayer;
                        targetEl.style.color = (mainPlayer.gender === 'm' ? 'var(--female-color)' : 'var(--male-color)');
                    }

                    document.getElementById('finalCommand').innerText = task.text;
                    document.getElementById('missionImg').src = task.img;
                    document.getElementById('resultOverlay').style.display = 'flex';
                }, 600);
            };
            grid.appendChild(card);
        }
    }

    function resetGame() {

    	// 1. æ ¸å¿ƒä¿®æ­£ï¼šç¢ºå¯¦è§£é™¤æ‰€æœ‰é›£åº¦æŒ‰éˆ•çš„é–å®š
    	document.querySelectorAll('.diff-btn').forEach(btn => {
        	btn.disabled = false; // æ¢å¾©æŒ‰éˆ•å¯é»æ“Šç‹€æ…‹
        	btn.style.cursor = 'pointer'; // æ¢å¾©æ‰‹æŒ‡å½¢ç‹€æŒ‡æ¨™
        	btn.style.opacity = ""; // æ¢å¾©åŸæœ¬çš„é€æ˜åº¦ï¼ˆè‹¥æœ‰è¨­å®šï¼‰
    	});

    	// 2. éš±è—çµæœå½ˆçª—èˆ‡å¡ç‰‡å€å¡Š
    	document.getElementById('resultOverlay').style.display = 'none';
    	document.getElementById('cardSection').style.display = 'none';
    
    	// 3. æ¢å¾©æŠ½ä¸»è§’æŒ‰éˆ•ä¸¦é‡ç½®æ–‡å­—
    	document.getElementById('drawBtn').style.display = 'block';
    	document.getElementById('displaySelection').innerHTML = '<p style="color:#888; margin: 0;">è«‹é»æ“ŠæŒ‰éˆ•æŠ½å‡ºä¸»è§’</p>';
	}

</script>
</body>
</html>
